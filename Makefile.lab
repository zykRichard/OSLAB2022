# ----- DO NOT MODIFY -----

export COURSE := OS2022
export MODULE := L3
export TOKEN  := HjgBRX3D
URL := 'http://jyywiki.cn/static/submit-os2022.sh'

submit:
	@cd $(dir $(abspath $(lastword $(MAKEFILE_LIST)))) && \
	  curl -sSLf '$(URL)' && \
	  curl -sSLf '$(URL)' | bash

git:
	@git add $(shell find . -name "*.c") $(shell find . -name "*.h") -A --ignore-errors
	@while (test -e .git/index.lock); do sleep 0.1; done
	@(uname -a && uptime) | git commit -F - -q --author='tracer-nju <tracer@nju.edu.cn>' --no-verify --allow-empty
	@sync

test: git
	@gcc $(shell find src/ -name "*.c")  \
	     $(shell find test/ -name "*.c") \
	     -Iframework -Itest -DTEST -lpthread -g -g3\
	     -o build/test
	@build/test

